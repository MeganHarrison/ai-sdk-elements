#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "ğŸš¨ RUNNING MANDATORY PLAYWRIGHT TESTS..."
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"

# Run lint and typecheck
npm run lint
npm run typecheck

# Run Playwright tests
npm run test:enforce

if [ $? -ne 0 ]; then
  echo ""
  echo "âŒ COMMIT BLOCKED: Playwright tests failed!"
  echo "âŒ You MUST fix all tests before committing."
  echo ""
  echo "Run these commands to debug:"
  echo "  npm run test:headed    # See tests in browser"
  echo "  npm run test:debug     # Debug mode"
  echo "  npm run test:report    # View test report"
  echo ""
  exit 1
fi

echo "âœ… All tests passed! Proceeding with commit..."